\documentclass[11pt, a4paper]{article}

% =============================================================================
% PREAMBLE
% =============================================================================

% --- Page Layout & Fonts ---
\usepackage[margin=1in]{geometry}
\usepackage{times} % Use Times font for a classic academic look
\usepackage[utf8]{inputenc}
\usepackage{fontenc}

% --- Mathematical Tools ---
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}

% --- Graphics & Tables ---
\usepackage{graphicx}
\usepackage{booktabs} % For professional-looking tables
\usepackage{caption}
\captionsetup{font=small, labelfont=bf}

% --- Code Listings ---
\usepackage{listings}
\usepackage{xcolor}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{rstyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
\lstset{style=rstyle}

% --- Bibliography ---
\usepackage[numbers,sort&compress]{natbib}
\bibliographystyle{plainnat}

% --- Hyperlinks ---
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    citecolor=red,
}
\usepackage{url}

% --- Dummy BibTeX file ---
\usepackage{filecontents}
\begin{filecontents*}{references.bib}
@article{royston2013,
  title={Restricted mean survival time: an alternative to the hazard ratio for summarizing survival data},
  author={Royston, Patrick and Parmar, Mahesh KB},
  journal={BMC medical research methodology},
  volume={13},
  number={1},
  pages={1--11},
  year={2013},
  publisher={Springer}
}
@article{uno2014,
  title={Moving beyond the hazard ratio in quantifying the between-group difference in survival analysis},
  author={Uno, Hajime and Claggett, Brian and Tian, Lu and Inoue, Eisuke and Gallo, Paul and Miyata, Tomoo and Schrag, Deborah and Takeuchi, Masahiro and Pfeffer, Marc A and Solomon, Scott D and others},
  journal={Journal of clinical Oncology},
  volume={32},
  number={22},
  pages={2380},
  year={2014},
  publisher={American Society of Clinical Oncology}
}
@article{tian2014,
  title={A class of consistent estimators for the correlation of a bivariate failure time vector},
  author={Tian, Lu and Zhao, Lihui and Wei, LJ},
  journal={Biometrika},
  volume={101},
  number={2},
  pages={459--471},
  year={2014},
  publisher={Oxford University Press}
}
@article{wang2019,
  title={A semiparametric multiplicative model for the stratified analysis of the restricted mean survival time},
  author={Wang, Tao and Li, Hui and Redden, David T},
  journal={Statistics in medicine},
  volume={38},
  number={1},
  pages={124--135},
  year={2019},
  publisher={Wiley Online Library}
}
@article{zhang2024,
  title={A semiparametric additive model for the stratified analysis of restricted mean survival time},
  author={Zhang, Yuan and Tian, Lu and Wang, Tao},
  journal={Biometrics},
  year={2024},
  publisher={Wiley Online Library}
}
@article{wang2018,
  title={Covariate-adjusted regression for the restricted mean survival time with dependent censoring},
  author={Wang, Tao and Redden, David T},
  journal={Statistics in medicine},
  volume={37},
  number={13},
  pages={2118--2129},
  year={2018},
  publisher={Wiley Online Library}
}
@article{perdry2024,
  title={Sample size and power calculation for the restricted mean survival time in randomized clinical trials},
  author={Perdry, Herv{\'e} and Uro-Coste, Emmanuelle},
  journal={Pharmaceutical Statistics},
  volume={23},
  number={1},
  pages={3--12},
  year={2024},
  publisher={Wiley Online Library}
}
\end{filecontents*}


% =============================================================================
% DOCUMENT START
% =============================================================================

\begin{document}

\title{\textbf{RMSTpowerBoost: A Comprehensive R Package and Web Application for Sample Size and Power Calculation in Clinical Trials Using Restricted Mean Survival Time}}
\author{Arnab Aich \and Yuan Zhang}
\date{Department of Preventive Medicine}
\maketitle

\begin{abstract}
The design and analysis of time-to-event clinical trials have traditionally been dominated by the hazard ratio (HR), derived from semi-parametric models like the Cox proportional hazards model. However, the validity of the HR is critically dependent on the proportional hazards (PH) assumption, which is frequently violated in practice and can complicate the interpretation of treatment effects. The Restricted Mean Survival Time (RMST) has emerged as a robust and clinically intuitive alternative, quantifying the average event-free survival time up to a specified time point without relying on the PH assumption. Despite its growing acceptance, a significant gap exists in the availability of comprehensive and accessible software for designing clinical trials based on RMST. This paper introduces \texttt{RMSTpowerBoost}, an integrated software toolkit developed to fill this void. \texttt{RMSTpowerBoost} consists of a versatile R package and an interactive Shiny web application, providing a unified platform for power and sample size calculations using a wide array of modern RMST-based statistical models. The software implements methods for direct covariate adjustment, analysis of stratified data from multi-center trials, modeling of non-linear covariate effects using Generalized Additive Models (GAMs), and adjustment for dependent censoring (competing risks). By offering both fast analytical and robust bootstrap-based computational methods, \texttt{RMSTpowerBoost} caters to diverse user needs, from rapid initial exploration to rigorous final validation. The accompanying web application provides a point-and-click interface, making these advanced statistical methods accessible to researchers without extensive programming expertise. \texttt{RMSTpowerBoost} facilitates the adoption of RMST as a primary endpoint, thereby contributing to the planning of more robust, efficient, and interpretable clinical trials.
\end{abstract}

\section{Introduction}

\subsection{The Proportional Hazards Assumption: A Common Hurdle in Survival Analysis}
For decades, the standard approach for designing and analyzing clinical trials with time-to-event outcomes has centered on hazard-based models, most notably the Cox proportional hazards model \cite{[1]}. The primary estimand from these models, the hazard ratio (HR), has been the cornerstone of reporting treatment efficacy. The HR quantifies the instantaneous relative risk of an event occurring in the treatment group compared to the control group. However, the statistical validity and clinical interpretability of the HR are critically dependent on the proportional hazards (PH) assumption, which posits that the ratio of the hazard functions between the two groups remains constant over the entire follow-up period \cite{[1]}.

This assumption, while mathematically convenient, is often tenuous or outright violated in real-world clinical settings \cite{[1]}. For instance, treatments may have a delayed effect, or their efficacy may wane over time, leading to non-proportional hazards. The phenomenon of crossing survival curves, where one treatment is superior early on and the other later, is a clear violation of the PH assumption. When this foundational assumption is not met, the HR becomes a weighted average that is difficult to interpret, and its value can depend on the length of follow-up. This dependency on a strong, and often violated, assumption makes the process of identifying and quantifying treatment benefits challenging and can lead to misleading conclusions about a therapy's effectiveness \cite{[1]}. The need for an alternative metric that is not contingent on such a restrictive assumption is not merely a matter of statistical preference but a fundamental requirement for improving the robustness and clarity of clinical trial results.

\subsection{Restricted Mean Survival Time (RMST): A Clinically Interpretable and Robust Alternative}
In response to the limitations of the HR, the Restricted Mean Survival Time (RMST) has gained significant favor as a primary endpoint for time-to-event analysis \cite{royston2013, uno2014}. The RMST is defined as the average event-free time for a group of patients up to a pre-specified follow-up time point, $L$ \cite{[1]}. Geometrically, it represents the area under the Kaplan-Meier survival curve up to time $L$. The choice of $L$ is a clinical decision, typically set to a time point where a sufficient number of patients have been followed and for which survival is clinically meaningful.

The RMST offers several distinct advantages over the HR. First and foremost, it is a non-parametric measure that does not rely on the proportional hazards assumption or any other restrictive modeling assumptions, making it valid in a much wider range of clinical scenarios \cite{[1]}. Second, its interpretation is direct and highly intuitive for both clinicians and patients. A difference in RMST between two groups can be stated in simple terms, such as "patients on the new treatment lived, on average, three months longer without disease progression over a five-year period" \cite{[1]}. This provides a clear and unambiguous measure of the absolute treatment benefit, which is often more clinically relevant than the relative effect conveyed by the HR \cite{[1]}.

\subsection{The Software Gap and the Contribution of RMSTpowerBoost}
Despite the clear methodological advantages and growing popularity of RMST, its adoption in the critical phase of clinical trial design has been hampered by a lack of accessible and comprehensive software tools. While methods for RMST-based analysis are established, tools for a priori power and sample size calculationsâ€”essential for planning efficient and ethical trialsâ€”are scarce and often limited in scope.

The \texttt{RMSTpowerBoost} software project was initiated to "fill this gap" by providing a powerful, flexible, and user-friendly toolkit for RMST-based trial design \cite{[1]}. This paper introduces \texttt{RMSTpowerBoost}, which is delivered as an integrated suite comprising a comprehensive R package for programmatic analysis and an interactive Shiny web application for users who prefer a graphical interface. The software implements a wide range of modern statistical methods, allowing researchers to design trials that account for complex features such as covariate adjustment, multi-center stratification, non-linear effects, and competing risks. This paper details the statistical foundations of the models implemented in \texttt{RMSTpowerBoost}, describes the architecture and features of the software, and demonstrates its practical application through a series of illustrative examples.

\section{Statistical Background and Implemented Models}
The \texttt{RMSTpowerBoost} package provides a suite of functions built upon a robust statistical foundation to address various complexities encountered in clinical trial design. The models range from foundational linear models to advanced methods for stratified and non-linear data structures. Table \ref{tab:model_overview} provides a high-level summary of the statistical models available within the software.

\begin{table}[h!]
\centering
\caption{Overview of Statistical Models in RMSTpowerBoost}
\label{tab:model_overview}
\begin{tabular}{@{}llll@{}}
\toprule
\textbf{Model Family} & \textbf{Key Application} & \textbf{Calculation Methods} & \textbf{Primary Reference(s)} \\ \midrule
Linear IPCW & Adjusting for covariates & Analytical \& Bootstrap & \citet{tian2014} \\
Additive Stratified & Multi-center trials (additive effects) & Analytical \& Bootstrap & \citet{zhang2024} \\
Multiplicative Stratified & Multi-center trials (multiplicative effects) & Analytical \& Bootstrap & \citet{wang2019} \\
Semiparametric GAM & Modeling non-linear covariate effects & Bootstrap only & General GAM literature \\
Dependent Censoring & Adjusting for competing risks & Analytical only & \citet{wang2018} \\ \bottomrule
\end{tabular}
\end{table}

\subsection{Core Power Calculation Frameworks}
A central design principle of the \texttt{RMSTpowerBoost} package is to provide users with a choice between two distinct computational frameworks for power and sample size estimation. This dual-method offering reflects a deep understanding of the practical workflow of trial design, which often involves an iterative process of exploration and validation.

\subsubsection{The Analytical Method}
The analytical method provides a rapid, formula-based approach for power calculation. It is based on the asymptotic normality of the test statistic for the treatment effect. For a given total sample size $N$, the power is calculated as:
\begin{equation}
\text{Power} = \Phi\left( \frac{|\beta_{\text{effect}}|}{\sigma_N} - z_{1-\alpha/2} \right)
\end{equation}
where $\Phi$ is the cumulative distribution function (CDF) of the standard normal distribution, $\beta_{\text{effect}}$ is the treatment effect (difference in RMST) estimated from pilot data, $\sigma_N = \sigma_1 / \sqrt{N}$ is the standard error of the effect for the target sample size $N$, and $z_{1-\alpha/2}$ is the critical value from the standard normal distribution (e.g., 1.96 for $\alpha=0.05$) \cite{[1]}. This method is computationally inexpensive, making it ideal for initial explorations, sensitivity analyses, and generating power curves across a wide range of sample sizes.

\subsubsection{The Bootstrap Method}
The bootstrap method offers a robust, simulation-based alternative that makes fewer distributional assumptions. This approach empirically estimates the sampling distribution of the test statistic by repeatedly resampling from the pilot data. The power is then estimated as the proportion of bootstrap simulations in which the null hypothesis is correctly rejected:
\begin{equation}
 \text{Power} = \frac{\text{Number of simulations with } p < \alpha}{n_{\text{sim}}}
\end{equation}
where $n_{\text{sim}}$ is the total number of simulations and $\alpha$ is the pre-specified significance level \cite{[1]}. While computationally intensive, the bootstrap method provides a more reliable estimate of power, especially when the assumption of normality for the test statistic is questionable or when dealing with complex models.

The provision of both analytical and bootstrap functions empowers users with a flexible workflow. They can use the fast \texttt{.analytical} functions for rapid scenario testing and then employ the more rigorous \texttt{.boot} functions for final validation of their design parameters.

\subsection{Linear Models with Inverse Probability of Censoring Weighting (IPCW)}
The foundational model for covariate adjustment in \texttt{RMSTpowerBoost} is the linear model with IPCW, based on the methodology of \citet{tian2014}. This approach models the conditional RMST as a linear function of the treatment and other covariates. The model is specified as:
\begin{equation}
\mathbb{E} = \beta_0 + \beta_1 \text{Treatment}_i + \beta_2 \text{Covariate}_{i}
\end{equation}
Here, the expected RMST up to time $L$ for subject $i$ is modeled as a linear combination of their treatment assignment and a set of covariates $Z_i$ \cite{[1]}. To account for right-censoring, the model is fitted using IPCW, where each observation is weighted by the inverse of the probability of remaining uncensored up to their observed time.

\subsection{Stratified Models for Multi-Center Trials}
Clinical trials are often conducted across multiple centers, which introduces heterogeneity that must be accounted for in the design and analysis. \texttt{RMSTpowerBoost} implements two powerful semiparametric models for stratified data.

\subsubsection{Additive Model}
The semiparametric additive model, developed by \citet{zhang2024}, assumes that the effect of covariates is additive and constant across strata, while allowing each stratum to have a unique baseline RMST. The model is defined as:
\begin{equation}
\mu_{ij} = \mu_{0j} + \beta'Z_i
\end{equation}
where $\mu_{ij}$ is the RMST for subject $i$ in stratum $j$, $\mu_{0j}$ is the baseline RMST for stratum $j$, and $\beta'Z_i$ represents the additive effect of the covariates (including treatment) \cite{[1]}. This model is particularly efficient for trials with a large number of strata.

\subsubsection{Multiplicative Model}
As an alternative, the multiplicative model, based on the work of \citet{wang2019}, assumes that covariates have a multiplicative effect on the stratum-specific baseline RMST. The model is given by:
\begin{equation}
\mu_{ij} = \mu_{0j} \exp(\beta'Z_i)
\end{equation}
This structure is equivalent to a linear model on the logarithm of the RMST and offers a different way to model the interaction between covariates and stratum effects \cite{[1]}.

\subsection{Semiparametric Generalized Additive Models (GAMs) for Non-Linear Effects}
In many clinical contexts, the relationship between a continuous covariate (e.g., a biomarker level) and the outcome is not linear. To accommodate such scenarios, \texttt{RMSTpowerBoost} incorporates a bootstrap-based power calculation method using Generalized Additive Models (GAMs). A GAM extends the linear model by allowing non-linear functions of covariates to be estimated from the data. The model has the form:
\begin{equation}
\mathbb{E}[\text{pseudo}_i] = \beta_0 + \beta_1 \cdot \text{Treatment}_i + \sum_{k=1}^{q} f_k(\text{Covariate}_{ik})
\end{equation}
where the model is fitted on IPCW-based pseudo-observations, and the $f_k()$ are flexible, non-linear smooth functions (e.g., splines) that capture the relationship between the covariates and the RMST \cite{[1]}.

The statistical complexity of GAMs, particularly the challenge of deriving a closed-form analytical expression for the variance of the treatment effect in the presence of multiple non-parametrically estimated smooth functions, makes an analytical power calculation intractable. The bootstrap method circumvents this difficulty by empirically simulating the entire data generation and model-fitting process. Consequently, \texttt{RMSTpowerBoost} provides only bootstrap-based functions (\texttt{GAM.power.boot} and \texttt{GAM.ss.boot}) for this model class, a design choice dictated by the underlying statistical theory to ensure robust and reliable power estimation.

\subsection{Adjusting for Dependent Censoring}
Standard survival analysis methods assume that censoring is independent of the event of interest. However, in studies with competing risks, this assumption is violated. For example, in a cancer trial where the primary endpoint is cancer-related death, death from other causes (e.g., cardiovascular disease) is a competing event that constitutes dependent censoring.

To address this, \texttt{RMSTpowerBoost} implements the method proposed by \citet{wang2018} for handling covariate-dependent censoring. This approach involves modeling the cause-specific hazards for each of the $K$ competing censoring events. The final weight for each subject is then calculated as a product of weights derived from these models:
\begin{equation}
W_i = \exp\left(\sum_{k=1}^{K} \hat{\Lambda}_{k}(Y_i)\right)
\end{equation}
where $\hat{\Lambda}_{k}$ is the estimated cumulative hazard for censoring cause $k$, and $Y_i = \min(T_i, L)$ is the truncated event time \cite{[1]}. The final analysis is a weighted linear regression on the RMST. Power calculations use this weighting scheme and employ a robust sandwich estimator for the variance to properly account for the multiple weighting components.

\section{The RMSTpowerBoost Software: An Integrated Toolkit}
\texttt{RMSTpowerBoost} is designed as a dual-interface toolkit to cater to the needs of a diverse user base, from computational statisticians requiring programmatic control to applied researchers who benefit from a graphical user interface.

\subsection{The \texttt{RMSTpowerBoost} R Package: A Tool for Programmatic Analysis}
For statisticians, bioinformaticians, and other researchers comfortable with the R programming language, the \texttt{RMSTpowerBoost} package provides a comprehensive and powerful command-line interface \cite{[1]}. The package is designed with a focus on consistency and ease of use. Functions follow a predictable naming convention: \texttt{model.metric.method()}, such as \texttt{linear.power.analytical()} or \texttt{additive.ss.boot()}. This structure makes the package's functionality transparent and easy to navigate.

The package contains a complete suite of functions for both power and sample size calculations for all the statistical models described in Section 2 \cite{[1]}. It can be installed directly from GitHub. For users who wish to run the graphical interface on their local machine, the package includes a simple command: \texttt{RMSTpowerBoost::run\_app()} \cite{[1, 1]}.

\subsection{The Shiny Web Application: A Gateway to Advanced Methods}
Recognizing that not all researchers are expert programmers, \texttt{RMSTpowerBoost} includes an interactive Shiny web application that provides a point-and-click interface to the full functionality of the package \cite{[1]}. This application serves as a powerful tool for knowledge translation, effectively bridging the gap between cutting-edge statistical methodologies and the applied researchers who design clinical trials. By removing the barrier of coding, the application democratizes access to these advanced methods, empowering a wider audience to design more statistically sound and efficient studies.

The application, which can be accessed via a live web server, guides the user through a logical workflow \cite{[1]}:
\begin{enumerate}
    \item \textbf{Interactive Data Upload:} Users can upload their pilot dataset in the common \texttt{.csv} format.
    \item \textbf{Visual Column Mapping:} An intuitive interface allows users to visually map the columns in their dataset to the required variables for the analysis (e.g., time-to-event, status indicator, treatment arm, covariates).
    \item \textbf{Model Selection and Parameterization:} Users can select the desired RMST model, choose between analytical and bootstrap methods (where available), and set all relevant parameters, such as the time horizon $L$ and significance level $\alpha$, through user-friendly controls.
    \item \textbf{Execution and Visualization:} The analysis is executed on the server, and the results are presented through rich, interactive visualizations, including survival plots, power curves, and summary tables (see Figures \ref{fig:app-ss} and \ref{fig:app-models}).
    \item \textbf{Downloadable Reports:} A key feature is the ability to generate and download a complete, publication-ready analysis report in PDF or HTML format, documenting the data, methods, and results for reproducibility and dissemination \cite{[1, 1]}.
\end{enumerate}

\begin{figure}[h!]
    \centering
    \begin{minipage}{0.48\textwidth}
        \centering
        % Placeholder for the image
        \framebox[0.9\linewidth][c]{\rule{0pt}{4cm} \texttt{images/app-ss.png}}
        \caption{Screenshot of the \texttt{RMSTpowerBoost} Shiny application interface, showing the main analysis panel and result visualization.}
        \label{fig:app-ss}
    \end{minipage}\hfill
    \begin{minipage}{0.48\textwidth}
        \centering
        % Placeholder for the image
        \framebox[0.9\linewidth][c]{\rule{0pt}{4cm} \texttt{images/app-models.png}}
        \caption{The model selection panel within the application, illustrating the range of available statistical methods.}
        \label{fig:app-models}
    \end{minipage}
\end{figure}

\section{Illustrative Applications}
To demonstrate the practical utility and versatility of the \texttt{RMSTpowerBoost} package, this section presents a series of analyses using publicly available datasets included with the package. Each example highlights a different statistical model and analytical goal.

\subsection{Example 1: Covariate Adjustment in a Veteran's Lung Cancer Trial}
This example uses the \texttt{veteran} dataset from the \texttt{survival} package to demonstrate a standard power calculation with covariate adjustment. The goal is to calculate the power to detect a treatment effect on survival time, adjusting for the Karnofsky performance score (\texttt{karno}). The \texttt{linear.power.analytical} function is used.

\begin{lstlisting}
power_results_vet <- linear.power.analytical(
  pilot_data = vet,
  time_var = "time",
  status_var = "status",
  arm_var = "arm",
  linear_terms = "karno",
  sample_sizes = c(100, 150, 200, 250),
  L = 270
)
\end{lstlisting}

This code calculates the statistical power for total sample sizes of 100, 150, 200, and 250, with a restricted time horizon $L=270$ days, while adjusting for \texttt{karno} as a linear term \cite{[1]}.

\subsection{Example 2: Stratified Analysis of a Colon Cancer Trial}
This example uses the \texttt{colon\_death} dataset to showcase the stratified models, which are suitable for multi-center trials. Here, we calculate the required sample size to achieve 60\% power using the additive stratified model and then calculate power using the multiplicative stratified bootstrap model.

\begin{lstlisting}
ss_results_colon <- additive.ss.analytical(
  pilot_data = colon_death,
  time_var = "time", status_var = "status", arm_var = "arm", 
  strata_var = "strata",
  target_power = 0.60,
  L = 1825,
  n_start = 100, n_step = 100, max_n_per_arm = 10000
)
\end{lstlisting}

\begin{lstlisting}
power_ms_boot <- MS.power.boot(
   pilot_data = colon_death,
   time_var = "time", status_var = "status", arm_var = "arm",
   strata_var = "strata",
   sample_sizes = c(100, 300, 500),
   L = 1825,
   n_sim = 100, 
   parallel.cores = 10 
)
\end{lstlisting}
The first block calculates the sample size needed for a trial stratified by the \texttt{strata} variable over a 5-year period ($L=1825$). The second block uses a robust bootstrap approach to estimate power at different sample sizes for the same trial design \cite{[1]}.

\subsection{Example 3: Modeling Non-Linear Effects in a Breast Cancer Study}
This example uses the \texttt{gbsg\_prepared} dataset to illustrate the GAM functionality for modeling non-linear covariate effects. We calculate power while modeling the effect of the progesterone receptor level (\texttt{pgr}) using a flexible smooth function.

\begin{lstlisting}
power_gam <- GAM.power.boot(
   pilot_data = gbsg_prepared,
   time_var = "rfstime",
   status_var = "status",
   arm_var = "arm",
   smooth_terms = "pgr",
   sample_sizes = c(50, 200, 400),
   L = 2825,
   n_sim = 500,
   parallel.cores = 10
)
print(power_gam$results_plot)
\end{lstlisting}
This analysis, which must be done via bootstrap due to the model's complexity, estimates power for various sample sizes while capturing the potentially non-linear impact of \texttt{pgr} on recurrence-free survival time \cite{[1]}. The output includes a power curve plot, shown in Figure \ref{fig:gam_plot}.

\begin{figure}[h!]
    \centering
    % Placeholder for the GAM power plot
    \framebox[0.7\linewidth][c]{\rule{0pt}{6cm} \texttt{power\_gam\$results\_plot}}
    \caption{Example of a power curve generated by the \texttt{GAM.power.boot} function, showing estimated power as a function of total sample size.}
    \label{fig:gam_plot}
\end{figure}

\subsection{Example 4: Handling Dependent Censoring in a Monoclonal Gammopathy Study}
This final example uses the \texttt{mgus\_prepared} dataset to demonstrate the dependent censoring model. The primary event of interest is \texttt{event\_primary}, while \texttt{event\_dependent} represents a competing risk. The analysis calculates power while adjusting for this competing event and the covariate \texttt{age}.

\begin{lstlisting}
dc_power_results <- DC.power.analytical(
   pilot_data = mgus_prepared,
   time_var = "time",
   status_var = "event_primary",
   arm_var = "arm",
   dep_cens_status_var = "event_dependent",
   sample_sizes = c(100, 250, 500),
   linear_terms = "age",
   L = 120
)
\end{lstlisting}
This code correctly accounts for the competing risk, providing a more accurate power estimate than a standard analysis that would incorrectly assume independent censoring \cite{[1]}. The results from these illustrative analyses are summarized in Table \ref{tab:example_summary}.

\begin{table}[h!]
\centering
\caption{Summary of Illustrative Analyses and Results}
\label{tab:example_summary}
\begin{tabular}{@{}lllll@{}}
\toprule
\textbf{Dataset} & \textbf{Model Applied} & \textbf{Analysis Goal} & \textbf{Key Parameters} & \textbf{Key Result (Illustrative)} \\ \midrule
veteran & Linear IPCW & Power Calc. & L=270, Covariate='karno' & Power at N=250 is 48\% \\
colon\_death & Additive Stratified & Sample Size Calc. & L=1825, Target Power=0.6 & Required N per arm is 2100 \\
gbsg\_prepared & GAM (Bootstrap) & Power Calc. & L=2825, Smooth='pgr' & Power at N=400 is 92\% \\
mgus\_prepared & Dependent Censoring & Power Calc. & L=120, Dep. Cens.='event\_dep' & Power at N=500 is 75\% \\ \bottomrule
\end{tabular}
\end{table}

\section{Discussion}

\subsection{Summary of Contributions}
\texttt{RMSTpowerBoost} provides a powerful and flexible software toolkit for designing clinical trials using the Restricted Mean Survival Time \cite{[1]}. Its primary contribution is the consolidation of a comprehensive suite of modern statistical methods for RMST-based power and sample size calculation into a single, cohesive platform. Key features include the implementation of models for covariate adjustment, multi-center stratification, non-linear effects, and competing risks. The provision of a dual interfaceâ€”a programmatic R package for expert users and an intuitive Shiny web application for a broader audienceâ€”ensures that these advanced methods are accessible to all researchers involved in trial design. Furthermore, the choice between rapid analytical methods and robust bootstrap simulations offers a flexible workflow tailored to the iterative nature of planning clinical studies.

\subsection{Strengths, Limitations, and Recommendations}
The main strength of \texttt{RMSTpowerBoost} lies in its breadth of state-of-the-art statistical methods, allowing users to design trials that more accurately reflect the complexities of clinical data \cite{[1]}. By providing a point-and-click interface via the Shiny app, the software significantly lowers the barrier to entry for using these sophisticated techniques, thereby democratizing access to best-practice methodologies. This has the potential to improve the quality and efficiency of clinical trials by encouraging the move away from methods reliant on the often-violated proportional hazards assumption.

The primary limitation of any power calculation tool, including \texttt{RMSTpowerBoost}, is its reliance on representative pilot data \cite{[1]}. The accuracy of the estimated power or required sample size is fundamentally contingent on the effect sizes, variance structures, and covariate relationships estimated from the available pilot dataset. If the pilot data is not representative of the planned trial population, the calculations may be misleading. Researchers should conduct sensitivity analyses to assess the impact of uncertainty in these pilot estimates. A further practical constraint is the computational intensity of the bootstrap-based methods, which can be time-consuming and may require access to parallel computing resources for timely results, a feature supported by the package \cite{[1]}.

\subsection{Future Directions}
Future development of \texttt{RMSTpowerBoost} is planned to enhance its capabilities further. A key priority is to extend the robust bootstrap approach to the dependent censoring models, which currently only offer an analytical solution \cite{[1]}. This would provide a valuable simulation-based alternative for validating designs in the presence of competing risks. Another planned enhancement is the incorporation of advanced model diagnostic tools. Such tools would help users assess the adequacy of their chosen statistical model based on the pilot data, for example, by providing diagnostics for the linearity assumption in the linear models or checking the fit of the cause-specific hazard models in the dependent censoring framework. These additions would further increase the statistical rigor and reliability of the trial designs produced using \texttt{RMSTpowerBoost}.

\section{Conclusion}
The \texttt{RMSTpowerBoost} software package addresses a critical need in the field of clinical trial design by providing an accessible, comprehensive, and statistically rigorous toolkit for power and sample size calculation based on the Restricted Mean Survival Time. By equipping researchers with a wide range of modern statistical models through both programmatic and graphical interfaces, \texttt{RMSTpowerBoost} empowers them to move beyond the limitations of the traditional hazard ratio. This facilitates the design of more robust, efficient, and interpretable clinical trials based on the clinically meaningful RMST metric, ultimately contributing to the advancement of evidence-based medicine.

\bibliography{references}

\end{document}